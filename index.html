<!DOCTYPE html>
<html>
	<head>
		<title></title>

		<meta charset="utf-8">
		<meta name="description" content=""> 
		<meta name="keywords" content="">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link href="https://fonts.googleapis.com/css?family=Kavivanar|Open+Sans+Condensed:300,700" rel="stylesheet">

		<link rel="stylesheet" type="text/css" href="http://cdn.leafletjs.com/leaflet-0.7.1/leaflet.css " /> 
		<link rel="stylesheet" type="text/css" href="css/style.css">
		<link rel="stylesheet" type="text/css" href="css/styleaccueil.css">
		<link rel="stylesheet" type="text/css" href="css/stylegeoloc.css">


		<script type="text/javascript" src="js/js.js"></script>
		<script type="text/javascript" src="js/fontawesome-all.js"></script>
		<script type="text/javascript" src="http://cdn.leafletjs.com/leaflet-0.7.1/leaflet.js"></script>
		<script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
	</head>
	<body>
		<div id="fullpage">

			<!-- MENU VERTICAL -->
			<header>
				<nav>
					<ul class="container">
						<li class="timeline-block">
						 	<a href="1" class="marker active" id="1">
						 		<div class="fabloc" style="font-size: 1.2em; color:#FFFFFF">
							 		<span class="fas fa-home"></span>
							 	</div>
						 	</a>
						</li>

						<li class="timeline-block">
							<a href="2" class="marker" id="2">
						 		<div class="fabloc" style="font-size: 1.2em; color:#FFF">
							 		<span class="fas fa-map-marker-alt"></span>
							 	</div>
						 	</a>
						</li>

						<li class="timeline-block">
							<a href="3" class="marker" id="3">
						 		<div class="fabloc" style="font-size: 1.2em; color:#FFF">
							 		<span class="fas fa-subway"></span>
							 	</div>
						 	</a>
						</li>

						<li class="timeline-block">
							<a href="4" class="marker" id="4">
								<div class="fabloc" style="font-size: 1.2em; color:#FFF">
						 			<span class="fas fa-bus"></span>
						 		</div>
						 	</a>
						</li>
					</ul>
				</nav>
			</header>


			<section class="page intro">
				<div class="entete">
					<h1>En transport</h1>
				</div>
				<div class="introcontain">
					<div href="2" class="introrond">
						<p>
							Utilisez la géolocalisation
							<br>blabla
							<br>yryuty
						</p>
					</div>
					<div href="3" class="introrond">
						<div class="transparent"></div>
						<img src="img/paris-metro.jpg">
						<p>
							métro/carte
							<br>blabla
							<br>lorem ipsum
						</p>
					</div>
					<div href="4" class="introrond">
						<div class="transparent"></div>
						<img src="img/paris-bus.jpg">
						<p>
							bus
							<br>blabla
							<br>cvgdfgdfigtr
						</p>
					</div>
				</div>
			</section>

			<section class="page geoloc">
				<div class="contain">
					<h2>Utilisez la géolocalisation</h2>
					<div id="geodiv" style="display:block; overflow: hidden;">
						<div id="infogeoc">
							<p>Démarrer</p>
						</div>
						<div id="mapgeoc">
						</div>
					</div>
				</div>
			</section>

			<section class="page metro">
				<div class="contain">
					<h2>métro/carte</h2>
				</div>
				
			</section>

			<section class="page bus">
				<div class="contain">
					<h2>les bus</h2>
				</div>
			</section>
		</div>
			
		<script>
			var map; 

			function redimension(){
				var window_height = $(window).height();
				var window_width = $(window).width();
				var ul_height = $('ul').height();
				var h2_height = $('h2').height();
				var h2_padding = $('h2').css('padding-top');

				$('ul').css('margin-top', window_height/2 - ul_height/2);

				$('.page').each(function(){
					$(this).css('width', window_width);
				})
				$('.page').each(function(){
					$(this).css('height', window_height);
				})
				$('#fullpage').css('width', window_width*4);

				$('.introrond').css('width', '25%');
				var rond = $('.introrond').width();
				$('.introrond').css('height', rond);

				$('#geodiv').css('height', window_height - (h2_height + parseInt(h2_padding)*2) );
			};
			
			function mapGeoloc(){	
				map = L.map('mapgeoc').setView([48.841946199999995, 2.2687775], 15);

				L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
				    attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
				}).addTo(map);
			}


			function geolocalisation() {
			    if (navigator.geolocation) {
			        navigator.geolocation.getCurrentPosition(position);
			    } else {
			        console.log("Geolocation is not supported by this browser.");
			    }
			}
			var lat;
			var lng;

			function position(position) {
			    lat = position.coords.latitude; 
			    lng = position.coords.longitude;

			   map.panTo(new L.LatLng(lat, lng));

			   L.marker([lat,lng]).addTo(map)
						    .bindPopup('vous êtes là')
						    .openPopup();
			}

			function stationalentour(){
				$.ajax({
					type:'GET',
					url:'http://nominatim.openstreetmap.org/search',
					dataType :'jsonp',
					jsonpCallback :'data',
				})
			}

			$(document).ready(function(){
				redimension();
				var window_width = $(window).width();

				$('.marker').each(function(){
			    	var id = $(this).attr('id');
			    		// 1/20 de la barre
			    	var percent = $('.container').height()/5;
			    	if( id == 1){
			    		$(this).css('margin-top', 0);
			    	}
			    	else{
			    		$(this).css('margin-top', percent * parseInt(id-1));
			    	}
			    	
			    });

				$('header a, .introrond').click(function(e){
					e.preventDefault(); 

					$('header a').removeClass('active');

					var a_href = $(this).attr('href');
					var elementOffset = window_width * parseInt(a_href) -  window_width;

					$("html, body").animate({ scrollLeft : elementOffset }, 850);
					
					$("#"+a_href).addClass('active');

					});

				$('#infogeoc p').click(function(){
					geolocalisation();
					stationalentour();
				})

				mapGeoloc();

			});

		</script>
	</body>
</html>